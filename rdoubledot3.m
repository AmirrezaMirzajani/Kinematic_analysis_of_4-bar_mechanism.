function Rdoubledot3=rdoubledot3(r2,teta1,teta2,tetadot2,tetadoubledot2,r1)

         Rdoubledot3=-(sin(teta2)*sin(teta3(teta1,teta2,r1,r2))*r2*(tetadot2)^2+ ...
         cos(teta2)*cos(teta3(teta1,teta2,r1,r2))*r2*(tetadot2)^2 ...
         -(sin(teta3(teta1,teta2,r1,r2)))^2*r3(teta1,teta2,r2,r1) ...
         *tetadot3(tetadot2,r2,teta2,teta1,r1) ...
         +sin(teta2)*cos(teta3(teta1,teta2,r1,r2))*r2*tetadoubledot2 ...
         -cos(teta2)*sin(teta3(teta1,teta2,r1,r2))*r2*tetadoubledot2 ...
         -2*sin(teta3(teta1,teta2,r1,r2))*cos(teta3(teta1,teta2,r1,r2))...
         *r3(teta1,teta2,r2,r1)*tetadot3(tetadot2,r2,teta2,teta1,r1) ...
         -r3(teta1,teta2,r2,r1)*(tetadot3(tetadot2,r2,teta2,teta1,r1))^2*...
         (cos(teta3(teta1,teta2,r1,r2)))^2 ...
         +2*sin(teta3(teta1,teta2,r1,r2))*rdot3(r2,tetadot2,teta1,teta2,r1)...
         *tetadot3(tetadot2,r2,teta2,teta1,r1) ...
     /((sin(teta3(teta1,teta2,r1,r2)))^2+(cos(teta3(teta1,teta2,r1,r2)))^2));
 
 
      
end

